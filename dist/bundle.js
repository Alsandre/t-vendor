(()=>{"use strict";function t(t){return document.querySelector(t)}function e(e,n="block"){let a=t(e),s=window.getComputedStyle(a);a.style.display="none"===s.display?n:"none"}function n(e,n="ADDITION"){let a=t(`#${e} span.basket-product-amount`),s=t(`#${e} span.basket-product-sum`),i=t(`#${e} span.basket-product-price`),r=a.textContent;switch(s.textContent,n){case"ADDITION":a.textContent=++r,s.textContent=(+s.textContent+ +i.textContent).toFixed(2);break;case"SUBTRACTION":1==+a.textContent&&t(`#${e}`).remove(),a.textContent=--r,s.textContent=(+s.textContent-+i.textContent).toFixed(2)}o()}function a(e){t("#menu").innerHTML="",e.forEach((e=>{let n=t("#menu"),a=new i(e.productName,e.review,e.id,e.imageUrl,e.price);n.appendChild(a)}))}function s(n){t("#side-menu").innerHTML="",n.forEach((n=>{let s=document.createElement("li");s.textContent=n,s.addEventListener("click",(n=>{t("#selected-tagname").textContent=n.currentTarget.textContent;let s=t(".clear-tagname");"none"===window.getComputedStyle(s).display&&e(".clear-tagname","inline-block"),function(t){let e=t.currentTarget.textContent,n=JSON.parse(localStorage.getItem("fresh-menu")).filter((t=>t.categoryTag.includes(e)));a(n)}(n)})),t("#side-menu").appendChild(s)}))}function o(){let e=0,n=document.querySelectorAll(".basket-list .basket-product-sum");console.log(n),n.forEach((t=>{let n=+t.textContent;e+=n})),t("#basket-total").textContent=e.toFixed(2)}class i extends HTMLElement{static get observedAttributes(){return["product-name","image-url","description"]}constructor(t,e,n,a,s){super(),this.title=t,this.description=e,this.imageUrl=a,this.id=n,this.price=s,this.shadow=this.attachShadow({mode:"open"}),this.containerTag=document.createElement("div"),this.containerTag.setAttribute("class","card-container");const o=document.createElement("h2");o.setAttribute("class","name"),o.textContent=this.title;const i=document.createElement("div");i.setAttribute("class","image-frame");const r=document.createElement("img");r.setAttribute("src",this.imageUrl),r.setAttribute("alt",this.title),i.appendChild(r);const d=document.createElement("p");d.textContent=this.description,d.setAttribute("class","description");const c=document.createElement("span");c.innerHTML=`<span class="price-badge"><span class="price-whole">${Math.floor(this.price)}</span><span class="price-change">${(100*(this.price-Math.floor(this.price))).toFixed(0)}</span></span>`,this.addToBasket=document.createElement("span"),this.addToBasket.setAttribute("class","add-icon"),this.addToBasket.setAttribute("id",`add-${this.id}`),this.addToBasket.innerHTML='<span class="plus-sign">+</span><br><span class="add-badge">ADD</span>';let l=document.createElement("style");l.textContent="\n:host {\n    display: block;\n}\n.card-container {\n  box-sizing: border-box;\n    width: 170px;\n    height: 260px;\n    margin: 2rem auto;\n    background: url(./assets/deco-card.png);\n    background-size: 100%;\n    position: relative;\n    padding-top: 30px;\n  }\n\n  .name {\n    margin-block-end: 0;\n    margin-block-start: 0;\n    text-align: center;\n    font-size: 20px;\n    line-height: 20px;\n    font-style: italic;\n  }\n  .price-badge {\n    background-color: rgba(193, 202, 194, 0.6);\n    border-radius: 50%;\n    overflow: hidden;\n    position: absolute;\n    top: 0;\n    right: -0.5em; \n    transform: translate(50%); \n    display: none;\n  }\n  .price-whole {\n    font-family: 'Lobster', cursive;\n    display: block;\n    width: 40px;\n    padding: 0.3rem 0 0 0;\n    font-weight: bold;\n    text-align: center;\n    background-color: rgba(255, 202, 92);\n    border-bottom: 1px solid #ccc;\n  }\n  .price-change {\n    font-family: 'Lobster', cursive;\n    display: block;\n    width: 40px;\n    padding: 0.1rem 0 0.3rem 0;\n    text-align: center;\n    font-style: italic;\n    font-size: 0.7em;\n    background-color: rgba(122, 175, 136, 1);\n  }\n  .add-icon {\n    background-color: rgba(193, 202, 194, 0.6);\n    padding: 0.1em;\n    border-bottom-left-radius: 10px;\n    border-top-right-radius: 4px;\n    border-bottom-right-radius: 4px;\n    text-align: center;\n    color: #333;\n    position: absolute;\n    top: 50px;\n    right: -0.5em; \n    transform: translate(50%); \n    transition: all 0.2s;\n    display: none;\n  }\n  .plus-sign {\n    // display: block;\n    font-family: courier;\n    font-weight: bold;\n    font-size: 20px;\n    line-height: 15px;\n    padding: 0;\n    margin: 0;\n  }\n  .add-badge {\n    font-size: 14px;\n    line-height: 10px;\n    font-family: courier;\n    margin: 0;\n  }\n  \n  .add-icon:hover {\n    background-color: rgba(193, 202, 194, 1);\n    border: 1px solid rgba(255, 202, 92);\n    cursor: pointer;\n  }\n\n  .image-frame {\n    width: 136px;\n    height: 115px;\n    margin: auto;\n  }\n  .image-frame img {\n    width: 100%;\n    height: 100%;\n  }\n  .description {\n    margin-top: 40px;\n    text-align: center;\n  }",this.containerTag.appendChild(o),this.containerTag.appendChild(i),this.containerTag.appendChild(d),this.containerTag.appendChild(c),this.containerTag.appendChild(this.addToBasket),this.shadow.appendChild(l),this.shadow.appendChild(this.containerTag)}connectedCallback(){this.containerTag.addEventListener("mouseover",(t=>{t.stopImmediatePropagation(),t.currentTarget.style.scale="1.05",this.shadow.querySelector(".price-badge").style.display="block",this.shadow.querySelector(".add-icon").style.display="block"})),this.containerTag.addEventListener("mouseleave",(t=>{t.stopImmediatePropagation(),t.currentTarget.style.scale="1",this.shadow.querySelector(".price-badge").style.display="none",this.shadow.querySelector(".add-icon").style.display="none"})),this.addToBasket.addEventListener("click",(e=>{e.currentTarget.style.scale="0.9",setTimeout((()=>{this.shadow.querySelector(".add-icon").style.scale="1"}),100),function(e){const a=t("#amount-field"),s=t(".pot-icon");a.textContent=""===a.textContent?1:++a.textContent,s.style.animationName="bump",setTimeout((()=>{s.style.animationName=""}),100),function(e){let a=e.replace("add-",""),s=`basket-${a}`;if(t(`#${s}`))n(s);else{let e=JSON.parse(localStorage.getItem("fresh-menu")).find((t=>t.id===a)),o=function(t,e,a,s){let o=document.createElement("li");o.classList.add("basket-item"),o.setAttribute("id",t);let i=document.createElement("span");i.textContent=e,i.classList.add("basket-product-name");let r=document.createElement("span");r.textContent=a,r.classList.add("basket-product-price");let d=document.createElement("span");d.textContent=1,d.classList.add("basket-product-amount");let c=document.createElement("span");c.textContent=1*a,c.classList.add("basket-product-sum");let l=document.createElement("button");l.textContent="-",l.onclick=()=>n(t,"SUBTRACTION"),l.classList.add("remove-button");let p=document.createElement("button");return p.textContent="+",p.onclick=()=>n(t,"ADDITION"),p.classList.add("add-button"),o.appendChild(i),o.appendChild(r),o.appendChild(d),o.appendChild(c),o.appendChild(l),o.appendChild(p),o}(s,e.productName,e.price);t(".basket-list").appendChild(o)}}(e)}(e.currentTarget.id),function(t){let e,n=JSON.parse(localStorage.getItem("order-amount")),a=JSON.parse(localStorage.getItem("fresh-menu")).find((e=>`add-${e.id}`===t));e=n&&n.length>0?n.find((e=>`add-${e.id}`===t))?n.map((e=>`add-${e.id}`===t?{...e,amount:e.amount+1}:e)):[...n,{...a,amount:1}]:[{...a,amount:1}],localStorage.setItem("order-amount",JSON.stringify(e))}(e.currentTarget.id)}))}}document.createElement("template").innerHTML='\n<style>.basket {\n    position: relative;\n    width: 40%;\n    min-width: 400px;\n    height: auto;\n    padding: 2rem;\n    position: fixed;\n    background-color: #e7ebe3;\n    border-radius: 20px;\n    box-shadow: 1px 1px 10px black, -1px -1px 20px black;\n    top: 6rem;\n    right: 50%;\n    transform: translateX(50%);\n    z-index: 100;\n    // display: none;\n}\n.basket-list {\n    list-style: none;\n}\n.basket-item {\n    background-color: #ccc;\n    display: flex;\n    justify-content: space-between;\n    text-align: center;\n}\n.remove-button-space {\n    width: 50px;\n    \n}\n.basket-product-name{\n    flex: 1 0 100px;\n    border-right: 1px solid #333;\n}\n.basket-product-price {\n    flex-basis: 60px;\n}\n.basket-product-amount {\n    flex-basis: 80px;\n}\n.basket-product-sum {\n    flex-basis: 60px;\n}\n.basket-total {\n    margin: 0.3rem 0;\n    padding: 0.5rem;\n    display: flex;\n    justify-content: flex-end;\n}\n#basket-total {\n    width: 90px;\n    text-align: left;\n    padding-left: 0.3em;\n}\n.basket-actions {\n    margin-top: 0.3rem;\n    display: flex;\n    justify-content: space-around;\n}\n.basket-actions button {\n    background-color: rgba(255, 202, 92);\n    padding: 0.5em;\n    border-radius: 8px;\n    border: none;\n    cursor: pointer;\n    border: 1px solid transparent;\n}\n.basket-actions button:hover,\n.basket-actions button:active {\n    scale: 1.03;\n    border: 1px solid #333;\n}</style>\n<div class="basket" id="basket">\n<ul class="basket-list">\n  <li class="basket-item">\n    <span class="border basket-product-name">Name</span>\n    <span class="border basket-product-price">Price</span>\n    <span>x</span>\n    <span class="border basket-product-amount">Amount</span>\n    <span>=</span>\n    <span class="border basket-product-sum">Sum</span>\n    <span class="remove-button-space"></span>\n  </li>\n</ul>\n<div class="basket-total">\n  <span>total:</span><span id="basket-total"></span>\n</div>\n<div class="basket-actions">\n  <button id="close-basket">close basket</button>\n  <button id="place-order">place order</button>\n</div>\n</div>';class r extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.template=document.createElement("div"),this.shadow.appendChild=template}}customElements.define("green-basket",r),customElements.define("product-card",i);let d=[];const c=t(".basket-button"),l=t("#backdrop"),p=t("#clear-basket"),u=t("#close-basket"),m=t("#search-bar"),b=t("#search-by-name"),h=t(".clear-tagname");b.oninput=t=>{a(JSON.parse(localStorage.getItem("fresh-menu")).filter((e=>e.productName.toLowerCase().includes(t.target.value.toLowerCase()))))},h.addEventListener("click",(()=>{t("#selected-tagname").textContent="",e(".clear-tagname","inline-block"),a(JSON.parse(localStorage.getItem("fresh-menu")))})),m.oninput=t=>{return e=t,n=d,a=s,console.log(e.target.value),void a(n.filter((t=>t.includes(e.target.value))));var e,n,a},u.onclick=()=>{e("#basket"),e("#backdrop")},p.onclick=()=>{t(".basket-list").textContent="",o()},l.addEventListener("click",(()=>{e("#basket"),e("#backdrop")})),c.onclick=function(){e("#basket"),e("#backdrop"),o()},(async()=>{const t=await fetch("https://tvendor-4db67-default-rtdb.europe-west1.firebasedatabase.app/productList.json"),e=await t.json();e.forEach((t=>{t.categoryTag.forEach((t=>{d.includes(t)||d.push(t)}))})),a(e),s(d),localStorage.setItem("fresh-menu",JSON.stringify(e))})(),t(".add-icon")})();